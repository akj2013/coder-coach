## EB 서버 URL 요청 흐름도

---

# ✅ 시스템 구성 요약
| 구분                   | 값                                                                          |
| -------------------- | -------------------------------------------------------------------------- |
| 📡 웹 서버 URL          | `http://coder-coach-env.eba-xxfsytmp.ap-northeast-1.elasticbeanstalk.com/` |
| 🌐 웹 서버 퍼블릭 IP       | `35.78.10.10` (Elastic Beanstalk의 EC2 인스턴스)                                |
| 🧑‍💻 로컬 PC의 프라이빗 IP | `192.168.3.20` (공유기 내부 IP)                                                 |
| 🧑‍💻 로컬 PC의 퍼블릭 IP  | `60.105.38.83` (외부에서 보는 나의 공인 IP)                                          |

---

# ✅ 요청 흐름 설명
1. [브라우저에서 요청] <br>
   └▶ http://coder-coach-env.eba-xxfsytmp.ap-northeast-1.elasticbeanstalk.com/

2. [Route53 or DNS] <br>
   └▶ 이 URL은 내부적으로 퍼블릭 IP `XX.XX.XX.10`으로 연결됨

3. [Elastic Beanstalk] <br>
   └▶ EB 환경은 EC2 인스턴스를 가지고 있고, 그 안에 Nginx가 리버스 프록시 역할을 수행

4. [Nginx → 내부 Spring Boot 앱으로 프록시 전달] <br>
   └▶ /articles 같은 요청은 EC2 내 `application.jar`가 리스닝 중인 포트(예: 5000)으로 포워딩

5. [EC2 인스턴스 보안 그룹] <br>
   └▶ 외부에서 EC2로 들어오는 요청이 보안 그룹 인바운드 규칙에 의해 허용되어야 함 <br>
   ▶ 즉, `XX.XXX.X8.X3/32` 같은 퍼블릭 IP가 허용돼야 접속 가능

6. [응답 전달]
   └▶ Spring Boot가 응답 생성 → Nginx가 받아서 클라이언트에게 전달

---

# ✅ 도식 (요약 플로우)
   [당신의 PC: XX.XXX.XX.XX] <br>
   ↓  (웹브라우저 요청) <br>
   [Elastic Beanstalk 도메인] <br>
   ↓  (DNS → 퍼블릭 IP: XX.XX.XX.10) <br>
   [EB EC2 인스턴스 (Nginx)] <br>
   ↓  (리버스 프록시) <br>
   [내부 Spring Boot 앱] <br>
   ↓ <br>
   [결과 응답] <br>
   ↓ <br>
   [당신의 PC로 전달] <br>

---

# ✅ 보안 그룹 체크 포인트
   EC2 보안 그룹 인바운드 규칙

포트: 22 (SSH), 80 또는 5000 (HTTP 또는 앱 포트)

IP: XX.XXX.XX.83/32 (또는 더 넓은 대역 XX.XXX.XX.0/24)

Elastic Beanstalk가 프록시를 담당하므로, 직접 EC2 앱 포트를 노출하지 않아도 됨 (보안성 ↑)

---

# 🧠 핵심 용어 먼저 정리
| 용어                          | 뜻                                                                       |
| --------------------------- | ----------------------------------------------------------------------- |
| **프록시 서버**                  | 클라이언트(브라우저)와 서버 사이에 위치해서, 요청을 대신 전달해주는 중간자 역할                           |
| **리버스 프록시 (Reverse Proxy)** | 사용자의 요청을 받아서, 내부 서버에 대신 요청을 보내고 응답을 사용자에게 돌려주는 프록시                      |
| **Nginx (엔진엑스)**            | 웹서버 소프트웨어이며, 리버스 프록시로 자주 사용됨                                            |
| **앱 포트 노출**                 | EC2 서버 내부에서 실행되는 애플리케이션이 사용하는 포트(예: 8080)를 외부에 직접 열어주는 것. 보안상 위험할 수 있음. |

---

# 🚗 실제 상황에 비유
1. 프록시 서버란? (일반 프록시)
   당신이 어떤 웹사이트에 접속하고 싶은데, 직접 접속하지 않고 대리인에게 부탁해서 대신 접속하게 하는 방식입니다.

예를 들어, 회사에서 인터넷 검열 때문에 유튜브에 접속 못할 때, 프록시 서버를 통해 몰래 우회해서 접속하는 것과 비슷합니다.

2. 리버스 프록시는 반대 역할
   이번엔 사용자가 특정 웹사이트를 접속할 때, 그 웹사이트가 실제로는 다른 내부 서버에 요청을 보내는 구조입니다.

Nginx가 앞에 서서 요청을 받아서 내부 서버로 전달하고 응답을 대신 보내주는 구조입니다.

사용자 ─→ Nginx (리버스 프록시) ─→ 내부 서버 (예: Spring Boot 앱 8080포트)

---

# 🖥️ 실제 서버 상황으로 설명

일반적인 EC2에서 앱 구동 방식
EC2 인스턴스에서 Spring Boot 앱을 실행하면 보통 http://your-ip:8080 같은 형태로 열립니다.

문제: 포트 8080을 외부에 열면 보안상 위험할 수 있습니다.
누가 앱 내부 URL을 알면 마음대로 호출할 수 있음.

---

# 🌐 Elastic Beanstalk + Nginx 구조
Elastic Beanstalk는 EC2 인스턴스를 자동으로 만들어서 앱을 올려주는 플랫폼입니다.

이때 Beanstalk는 자동으로 Nginx를 EC2 인스턴스 앞단에 설치해서,
사용자의 요청을 받고, 내부 애플리케이션(Spring Boot 등)으로 리버스 프록시를 합니다.

사용자 브라우저 <br>
│<br>
▼<br>
[ Nginx (80포트로 받음) ]   ← EC2 인스턴스의 퍼블릭 IP는 이쪽만 열림 <br>
│ <br>
▼ <br>
[ Spring Boot 앱 (8080포트 등 내부 포트) ]  ← 외부에 직접 노출되지 않음 <br>
✅ 왜 이렇게 하냐?
보안: 내부 앱 포트(예: 8080)는 외부에 공개하지 않음.

유연성: Nginx가 로드 밸런싱, 압축, 캐시, HTTPS 적용 등을 대신 처리해줌.

유지보수 편리: Nginx 설정만 바꿔서 앱을 교체하거나 포트만 바꿔도 사용자 입장에서는 URL이 동일하게 유지됨.

---

# 🔐 "앱 포트를 노출하지 않아도 됨 (보안성 ↑)" 이 말의 의미
Spring Boot 앱이 8080 포트에서 실행된다고 해도, 외부에서는 그 포트를 직접 보지 못합니다.
외부 사용자는 오직 Nginx가 열어둔 80(HTTP), 443(HTTPS) 포트로만 접근 가능합니다.

외부 사용자는 http://내도메인.com 으로 접속

실제 앱은 localhost:8080 에서 실행 중

Nginx가 8080으로 내부 요청을 대신 전달함 (리버스 프록시)

---

# 🧩 결론
Nginx는 앞단에서 들어오는 요청을 받아 앱으로 전달해주는 리버스 프록시 역할

프록시 구조 덕분에 내부 앱 포트는 외부에 노출하지 않아도 되고, 더 보안이 강화됨

Elastic Beanstalk는 이 구조를 자동으로 구성해줘서 편리함